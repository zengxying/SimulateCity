System.register("chunks:///_virtual/BuildingComp.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,o,i;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.Component}],execute:function(){var r;e._RF.push({},"00ee3w19x1G44WzIBSZAbIH","BuildingComp",void 0);var c=o.ccclass;o.property,t("BuildingComp",c("BuildingComp")(r=function(t){function e(){for(var n,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(n=t.call.apply(t,[this].concat(o))||this).data=void 0,n}return n(e,t),e.prototype.changeState=function(t){this.data.state=t},e}(i))||r);e._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingData.ts",["cc"],(function(i){var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"2c090BmfdlFIrR8nEKCUTF7","BuildingData",void 0);i("BuildingData",(function(){this.widthx=void 0,this.heightz=void 0,this.lv=void 0,this.id=void 0,this.state=void 0}));t._RF.pop()}}}));

System.register("chunks:///_virtual/BuildingOperateLogic.ts",["cc","./GlobalConst.ts","./util.ts","./MapMgr.ts"],(function(t){var i,n,o,e,s,c,u,r,_;return{setters:[function(t){i=t.cclegacy,n=t.Vec2,o=t.v3},function(t){e=t.GlobalConst,s=t.v3_1,c=t.v2_2,u=t.v2_1},function(t){r=t.Util},function(t){_=t.MapMgr}],execute:function(){i._RF.push({},"5e10aYoFCBEU6qKKPlCZApe","BuildingOperateLogic",void 0);var h=function(t){return t[t.NONE=0]="NONE",t[t.LONG_TOUCH_CHECK=1]="LONG_TOUCH_CHECK",t[t.LONG_TOUCH_RUNNING=2]="LONG_TOUCH_RUNNING",t[t.SHORT_TOUCH_RUNNING=3]="SHORT_TOUCH_RUNNING",t}(h||{});t("BuildingOperateLogic",function(){function t(t){this.target=void 0,this._longTouchTime=1,this._state=h.NONE,this._startTouchPoint=new n,this._comp=void 0,this._comp=t,this.target=r.createSphere(this._comp.node.parent,.5,o())}var i=t.prototype;return i.onTouchStart=function(t){if(e.interruptBuildingOp)return console.warn("中断操作中...............");var i=t.getAllTouches();this._isSinglePoint(t)&&(this._comp.scheduleOnce(this.onLongTouch.bind(this),this._longTouchTime),this._state=h.LONG_TOUCH_CHECK,i[0].getLocation(this._startTouchPoint))},i.onLongTouch=function(){this._state=h.LONG_TOUCH_RUNNING,_.ins.getHitPointToGridPosition(this._startTouchPoint,s,c),this.target.setPosition(s),console.log("长按中....................")},i._isSinglePoint=function(t){return t.getAllTouches().length<=1},i.checkMoveBuild=function(){return this._state==h.LONG_TOUCH_RUNNING},i.onTouchMove=function(t){if(e.interruptBuildingOp)return console.warn("中断操作中...............");var i=t.getAllTouches();this._isSinglePoint(t)&&(i[0].getLocation(this._startTouchPoint),t.getDelta(u),this._state==h.LONG_TOUCH_CHECK&&u.lengthSqr()>100&&(this._state=h.SHORT_TOUCH_RUNNING,this._comp.unschedule(this.onLongTouch)),this._state==h.LONG_TOUCH_RUNNING&&(_.ins.getHitPointToGridPosition(this._startTouchPoint,s,c),this.target.setPosition(s)),this._state,h.SHORT_TOUCH_RUNNING)},i.onTouchEnd=function(t){if(this._state=h.NONE,e.interruptBuildingOp)return console.warn("中断操作中...............")},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/CameraControllerComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConst.ts","./msg.ts","./MsgEvent.ts"],(function(e){var t,i,o,n,s,a,r,l,c,h,p,d,u,_;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,o=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){s=e.cclegacy,a=e._decorator,r=e.Quat,l=e.Vec3,c=e.CameraComponent,h=e.Component},function(e){p=e.GlobalConst,d=e.v3_1},function(e){u=e.Msg},function(e){_=e.MsgEvent}],execute:function(){var m,f,v,y,C,A,g,S,b;s._RF.push({},"4cb760qrA9GyZze+ibYTgjy","CameraControllerComp",void 0);var P=a.ccclass,w=a.property,E=new r,O=new l,T=new l;e("CameraControllerComp",(m=P("CameraControllerComp"),f=w({slide:!0,range:[.05,.5,.01]}),m(((b=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return(t=e.call.apply(e,[this].concat(s))||this)._camera=void 0,o(t,"moveSpeed",C,n(t)),o(t,"moveSpeedShiftScale",A,n(t)),o(t,"damp",g,n(t)),o(t,"rotateSpeed",S,n(t)),t._velocity=new l,t._position=new l,t._speedScale=1,t.distanceY=200,t._euler=new l,t._rotaRatio=.05,t}i(t,e);var s=t.prototype;return s.onLoad=function(){t.ins=this,p.camera=this._camera=this.node.getComponentInChildren(c),l.copy(this._position,this.node.getPosition()),l.copy(this._euler,this._camera.node.eulerAngles)},s.onEnable=function(){u.on(_.UPDATE_CAMERA_POSITION,this.updateCameraPosition.bind(this)),u.on(_.UPDATE_CAMERA_EULER_ANGLE,this.updateCameraEulerAngle.bind(this)),u.on(_.OP_TOUCH_ROTA,this.rotaView.bind(this)),u.on(_.OP_TOUCH_SCALE,this.scaleView.bind(this))},s.onDisable=function(){u.off(_.OP_TOUCH_SCALE,this.rotaView),u.off(_.OP_TOUCH_ROTA,this.scaleView)},s.updateCameraPosition=function(e){this.node.setPosition(e),this._position.set(e)},s.updateCameraEulerAngle=function(e){this._euler.set(e)},s.scaleView=function(e){Math.abs(this._position.y+e)<this.distanceY&&(l.transformQuat(d,l.UNIT_Z,this._camera.node.rotation),l.scaleAndAdd(this._position,this.node.position,d,e))},s.rotaView=function(e){},s.update=function(e){var t=Math.min(e/this.damp,1);l.transformQuat(d,this._velocity,this.node.rotation),l.scaleAndAdd(this._position,this._position,d,this.moveSpeed*this._speedScale),l.lerp(d,this.node.getPosition(),this._position,t),this.node.setPosition(d);var i=p.cameraMoveDir;i.lengthSqr()&&(l.transformQuat(O,l.FORWARD,this.node.rotation),O.normalize(),l.cross(T,O,l.UP),T.normalize(),l.scaleAndAdd(this._position,this._position,O,this.moveSpeed*this._speedScale*i.z),l.lerp(d,this.node.getPosition(),this._position,t),this.node.setPosition(d),l.scaleAndAdd(this._position,this._position,T,this.moveSpeed*this._speedScale*i.x),l.lerp(d,this.node.getPosition(),this._position,t),this.node.setPosition(d),l.scaleAndAdd(this._position,this._position,l.UP,this.moveSpeed*this._speedScale*i.y),l.lerp(d,this.node.getPosition(),this._position,t),this.node.setPosition(d)),r.fromEuler(E,this._euler.x,this._euler.y,this._euler.z),r.slerp(E,this._camera.node.rotation,E,t),this._camera.node.rotation=E,this._velocity.set()},s.moveView=function(e){console.log("转换出来的坐标:vec2 vec2",e.x,e.y);var t=1+this._position.y/this.distanceY*10;e.multiplyScalar(t),this._velocity.set(e.x,0,e.y)},s.moveView2=function(e){console.log("转换出来的坐标:vec2 vec2",e.x,e.y);var t=1+this._position.y/this.distanceY*10;e.multiplyScalar(t),this._velocity.set(e.x,0,e.y)},t.test=function(e){},t}(h)).ins=void 0,b.camera=void 0,C=t((y=b).prototype,"moveSpeed",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),A=t(y.prototype,"moveSpeedShiftScale",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),g=t(y.prototype,"damp",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),S=t(y.prototype,"rotateSpeed",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),v=y))||v));s._RF.pop()}}}));

System.register("chunks:///_virtual/csv2json.ts",["cc"],(function(e){var r;return{setters:[function(e){r=e.cclegacy}],execute:function(){r._RF.push({},"f6b65H8TEJImJVZbF2ulmkL","csv2json",void 0);e("parseCSV",(function(e){for(var r=[],t=e.split("\n"),n=t[1].split(","),s=t[2].split(","),c=0,l=s.length;c<l;c++)s[c]=s[c].replace(/\n|\r/g,"");for(var a=3,i=t.length-1;a<i;a++){var o={},u=t[a].split(",");if(u.length===s.length){for(var p=0,v=s.length;p<v;p++){var f=u[p];f=n[p].startsWith("n")?Number(f):f.replace(/[\n|\r]/g,""),o[s[p]]=f}r.push(o)}else console.warn("csv中行的长度不等于表头的长度")}return r}));r._RF.pop()}}}));

System.register("chunks:///_virtual/csvManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,r,n;return{setters:[function(e){t=e.createClass},function(e){r=e.cclegacy,n=e._decorator}],execute:function(){var i,s;r._RF.push({},"ee057O2MK9PwIHvruBDkuyS","csvManager",void 0);var u=n.ccclass,a=(n.property,[",",";","\t","|","^"]),o=["\r\n","\r","\n"],l=function(e,t,r,n){return r instanceof Array?"number"===r[t]?Number(n[t]):"boolean"===r[t]?"true"===n[t]||"t"===n[t]||"1"===n[t]:n[t]:isNaN(Number(e))?"false"==e||"true"==e||"t"==e||"f"==e?"true"===n[t]||"t"===n[t]||"1"===n[t]:n[t]:Number(n[t])},c={STANDARD_DECODE_OPTS:{skip:0,limit:!1,header:!1,cast:!1,comment:""},STANDARD_ENCODE_OPTS:{delimiter:a[0],newline:o[0],skip:0,limit:!1,header:!1},quoteMark:'"',doubleQuoteMark:'""',quoteRegex:/"/g,assign:function(){for(var e=Array.prototype.slice.call(arguments),t=e[0],r=e.slice(1),n=0,i=r.length;n<i;n++)for(var s in r[n])t[s]=r[n][s];return t},map:function(e,t){for(var r=[],n=0,i=e.length;n<i;n++)r[n]=t(e[n],n);return r},getType:function(e){return Object.prototype.toString.call(e).slice(8,-1)},getLimit:function(e,t){return!1===e?t:e},buildObjectConstructor:function(e,t,r){return function(n){var i=new Object,s=function(e,t){return i[e]=t};return r?e.forEach((function(e,i){s(e,l(t[i],i,r,n))})):e.forEach((function(e,r){s(e,l(t[r],r,null,n))})),i}},buildArrayConstructor:function(e,t,r){return function(n){var i=new Array(t.length),s=function(e,t){return i[e]=t};return r?e.forEach((function(e,i){s(e,l(t[i],i,r,n))})):e.forEach((function(e,r){s(e,l(t[r],r,null,n))})),i}},frequency:function(e,t,r){void 0===r&&(r=!1);for(var n=0,i=0,s=this.getLimit(r,e.length);i<s&&-1!==(i=e.indexOf(t,i));)i+=1,n++;return n},mostFrequent:function(e,t,r){for(var n,i=t.length-1;i>=0;i--)this.frequency(e,t[i],r)>0&&(n=t[i]);return n||t[0]},unsafeParse:function(e,t,r){var n,i,s=e.split(t.newline);function u(e){var r=e.shift();if(r.indexOf('"')>=0){for(var n=0,i=0,s=0;e.length>0&&(-1!==(n=r.indexOf('"',i))||s%2!=0);)-1!==n?(i=n+1,s++):r=r+t.newline+e.shift();var u,a=[],o=0,l=0,c=0,h=r.length;for(var f in r)if(r.hasOwnProperty(f)){var d=parseInt(f),v=r[f];0===d&&'"'===v&&(o++,l=1),'"'===v&&(o++,r[d-1]===t.delimiter&&l===d&&l++),'"'===v&&o%2==0&&(r[d+1]!==t.delimiter&&d+1!==h||(c=d,u=r.substring(l,c),a.push(u),c=l=c+2)),v===t.delimiter&&o%2==0&&((c=d)>l?(u=r.substring(l,c),a.push(u),c=l=c+1):c===l&&(a.push(""),c=l=c+1))}return(c=h)>=l&&(u=r.substring(l,c),a.push(u)),a}return r.split(t.delimiter)}for(t.skip>0&&s.splice(t.skip),t.header?(!0===t.header?(t.comment=u(s),t.cast=u(s),n=u(s)):"Array"===this.getType(t.header)&&(n=t.header),i=this.buildObjectConstructor(n,s[0].split(t.delimiter),t.cast)):i=this.buildArrayConstructor(n,s[0].split(t.delimiter),t.cast);s.length>0;){var a=u(s);a.length>1&&r(i(a),n[0])}return!0},safeParse:function(e,t,r){t.delimiter;var n=t.newline,i=e.split(n);return t.skip>0&&i.splice(t.skip),!0},encodeCells:function(e,t,r){for(var n=e.slice(0),i=0,s=n.length;i<s;i++)-1!==n[i].indexOf(this.quoteMark)&&(n[i]=n[i].replace(this.quoteRegex,this.doubleQuoteMark)),-1===n[i].indexOf(t)&&-1===n[i].indexOf(r)||(n[i]=this.quoteMark+n[i]+this.quoteMark);return n.join(t)},encodeArrays:function(e,t,r){var n=t.delimiter,i=t.newline;t.header&&"Array"===this.getType(t.header)&&r(this.encodeCells(t.header,n,i));for(var s=0,u=this.getLimit(t.limit,e.length);s<u;s++)r(this.encodeCells(e[s],n,i));return!0},encodeObjects:function(e,t,r){var n,i,s=t.delimiter,u=t.newline;for(var a in n=[],i=[],e[0])n.push(a),i.push(e[0][a]);!0===t.header?r(this.encodeCells(n,s,u)):"Array"===this.getType(t.header)&&r(this.encodeCells(t.header,s,u)),r(this.encodeCells(i,s));for(var o=1,l=this.getLimit(t.limit,e.length);o<l;o++){i=[];for(var c=0,h=n.length;c<h;c++)i.push(e[o][n[c]]);r(this.encodeCells(i,s,u))}return!0},parse:function(e,t,r){var n;if("Function"===this.getType(t)?(r=t,t={}):"Function"!==this.getType(r)?r=(n=[]).push.bind(n):n=[],t=this.assign({},this.STANDARD_DECODE_OPTS,t),this.opts=t,!t.delimiter||!t.newline){var i=Math.min(48,Math.floor(e.length/20),e.length);t.delimiter=t.delimiter||this.mostFrequent(e,a,i),t.newline=t.newline||this.mostFrequent(e,o,i)}return this.unsafeParse(e,t,r)&&(!(n.length>0)||n)},encode:function(e,t,r){var n;return"Function"===this.getType(t)?(r=t,t={}):"Function"!==this.getType(r)&&(r=(n=[]).push.bind(n)),(t=this.assign({},this.STANDARD_ENCODE_OPTS,t)).skip>0&&(e=e.slice(t.skip)),("Array"===this.getType(e[0])?this.encodeArrays:this.encodeObjects)(e,t,r)&&(!(n.length>0)||n.join(t.newline))}};e("CSVManager",u("CSVManager")(((s=function(){function e(){this._csvTables={},this._csvTableForArr={},this._tableCast={},this._tableComment={}}var r=e.prototype;return r.addTable=function(e,t,r){if(!this._csvTables[e]||r){var n={},i=[];c.parse(t,{header:!0},(function(e,t){n[e[t]]=e,i.push(e)})),this._tableCast[e]=c.opts.cast,this._tableComment[e]=c.opts.comment,this._csvTables[e]=n,this._csvTableForArr[e]=i}},r.getTableArr=function(e){return this._csvTableForArr[e]},r.getTable=function(e){return this._csvTables[e]},r.queryOne=function(e,t,r){var n=this.getTable(e);if(!n)return null;if(!t)return n[r];for(var i in n)if(n.hasOwnProperty(i)&&n[i][t]===r)return n[i]},r.queryByID=function(e,t){return this.queryOne(e,null,t)},r.queryAll=function(e,t,r){var n=this.getTable(e);if(!n||!t)return null;var i={};for(var s in n)n.hasOwnProperty(s)&&n[s][t]===r&&(i[s]=n[s]);return i},r.queryIn=function(e,t,r){var n=this.getTable(e);if(!n||!t)return null;for(var i={},s=Object.keys(n),u=s.length,a=0;a<u;a++){var o=n[s[a]];r.indexOf(o[t])>-1&&(i[s[a]]=o)}return i},r.queryByCondition=function(e,t){if(t.constructor!==Object)return null;var r=this.getTable(e);if(!r)return null;for(var n={},i=Object.keys(r),s=i.length,u=Object.keys(t),a=u.length,o=0;o<s;o++){for(var l=r[i[o]],c=!0,h=0;h<a;h++){var f=u[h];c=c&&t[f]===l[f]&&!n[i[o]]}c&&(n[i[o]]=l)}return n},r.queryOneByCondition=function(e,t){if(t.constructor!==Object)return null;var r=this.getTable(e);if(!r)return null;var n=Object.keys(t),i=n.length;for(var s in r){for(var u=r[s],a=!0,o=0;o<i;o++){var l=n[o];a=a&&t[l]===u[l]}if(a)return u}return null},t(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}())._instance=void 0,i=s))||i);r._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/EnumIndex.ts",["cc"],(function(n){var e;return{setters:[function(n){e=n.cclegacy}],execute:function(){e._RF.push({},"e488bVsHnBFQ5Z6/54rWlF7","EnumIndex",void 0);n("BuildingStateType",function(n){return n[n.SELECT=0]="SELECT",n[n.CLICK=1]="CLICK",n[n.MOVE=2]="MOVE",n[n.UPGRADE=3]="UPGRADE",n[n.NONE=4]="NONE",n}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/FreeCamera.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConst.ts"],(function(e){var t,i,o,n,s,r,h,a,p,d,_,c,l,u,y,E,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,o=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){s=e.cclegacy,r=e._decorator,h=e.Quat,a=e.Vec3,p=e.input,d=e.Input,_=e.game,c=e.KeyCode,l=e.v2,u=e.Component},function(e){y=e.v3_1,E=e.v2_1,v=e.v2_2}],execute:function(){var K,f,Y,S,m,k,M,D;s._RF.push({},"cfbf5HfxlpApq51WNvAEl36","FreeCamera",void 0);var T=r.ccclass,A=r.property,g=new h,P=new a,w=new a;e("FreeCamera",(K=T("tgxFreeCamera"),f=A({slide:!0,range:[.05,.5,.01]}),K((m=t((S=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return t=e.call.apply(e,[this].concat(s))||this,o(t,"moveSpeed",m,n(t)),o(t,"moveSpeedShiftScale",k,n(t)),o(t,"damp",M,n(t)),o(t,"rotateSpeed",D,n(t)),t._euler=new a,t._velocity=new a,t._position=new a,t._speedScale=1,t._eulerP=new a,t.keys=[],t.moveDir=new a,t.key2dirMap=null,t}i(t,e);var s=t.prototype;return s.onLoad=function(){p.on(d.EventType.MOUSE_WHEEL,this.onMouseWheel,this),p.on(d.EventType.TOUCH_START,this.onTouchStart,this),p.on(d.EventType.TOUCH_MOVE,this.onTouchMove,this),p.on(d.EventType.TOUCH_END,this.onTouchEnd,this),a.copy(this._euler,this.node.eulerAngles),a.copy(this._position,this.node.getPosition()),a.copy(this._eulerP,this.node.eulerAngles),p.on(d.EventType.KEY_DOWN,this.onKeyDown,this),p.on(d.EventType.KEY_UP,this.onKeyUp,this)},s.onDestroy=function(){p.off(d.EventType.MOUSE_WHEEL,this.onMouseWheel,this),p.off(d.EventType.TOUCH_START,this.onTouchStart,this),p.off(d.EventType.TOUCH_MOVE,this.onTouchMove,this),p.off(d.EventType.TOUCH_END,this.onTouchEnd,this),p.off(d.EventType.KEY_DOWN,this.onKeyDown,this),p.off(d.EventType.KEY_UP,this.onKeyUp,this)},s.update=function(e){var t=Math.min(e/this.damp,1);a.transformQuat(y,this._velocity,this.node.rotation),a.scaleAndAdd(this._position,this._position,y,this.moveSpeed*this._speedScale),a.lerp(y,this.node.getPosition(),this._position,t),this.node.setPosition(y),this.moveDir.lengthSqr()&&(a.transformQuat(P,a.FORWARD,this.node.rotation),P.normalize(),a.cross(w,P,a.UP),w.normalize(),a.scaleAndAdd(this._position,this._position,P,this.moveSpeed*this._speedScale*this.moveDir.z),a.lerp(y,this.node.getPosition(),this._position,t),this.node.setPosition(y),a.scaleAndAdd(this._position,this._position,w,this.moveSpeed*this._speedScale*this.moveDir.x),a.lerp(y,this.node.getPosition(),this._position,t),this.node.setPosition(y),a.scaleAndAdd(this._position,this._position,a.UP,this.moveSpeed*this._speedScale*this.moveDir.y),a.lerp(y,this.node.getPosition(),this._position,t),this.node.setPosition(y)),h.fromEuler(g,this._eulerP.x,this._eulerP.y,this._eulerP.z),h.slerp(g,this.node.rotation,g,t),this.node.rotation=g},s.onMouseWheel=function(e){var t=-e.getScrollY()*this.moveSpeed*.1;a.transformQuat(y,a.UNIT_Z,this.node.rotation),a.scaleAndAdd(this._position,this.node.position,y,t)},s.onTouchStart=function(e){_.canvas.requestPointerLock&&_.canvas.requestPointerLock()},s.onTouchMove=function(e){e.getStartLocation(E),console.log("v2_1.x > game.canvas.width * 0.4  "+E.x+" > "+.4*_.canvas.width),E.x,_.canvas.width,e.getDelta(v),this._eulerP.y-=v.x*this.rotateSpeed*.1,this._eulerP.x+=v.y*this.rotateSpeed*.1},s.onTouchEnd=function(e){document.exitPointerLock&&document.exitPointerLock(),e.getStartLocation(E),E.x<.4*_.canvas.width&&(this._velocity.x=0,this._velocity.z=0)},s.onKeyDown=function(e){var t=e.keyCode;t!=c.KEY_A&&t!=c.KEY_S&&t!=c.KEY_D&&t!=c.KEY_W||-1==this.keys.indexOf(t)&&(this.keys.push(t),this.updateDirection()),t==c.KEY_Q?this.moveDir.y=-1:t==c.KEY_E&&(this.moveDir.y=1)},s.onKeyUp=function(e){var t=e.keyCode;if(t==c.KEY_A||t==c.KEY_S||t==c.KEY_D||t==c.KEY_W){var i=this.keys.indexOf(t);-1!=i&&(this.keys.splice(i,1),this.updateDirection())}t!=c.KEY_Q&&t!=c.KEY_E||(this.moveDir.y=0)},s.updateDirection=function(){null==this.key2dirMap&&(this.key2dirMap={},this.key2dirMap[0]=l(0,0),this.key2dirMap[c.KEY_A]=l(-1,0),this.key2dirMap[c.KEY_D]=l(1,0),this.key2dirMap[c.KEY_W]=l(0,1),this.key2dirMap[c.KEY_S]=l(0,-1),this.key2dirMap[1e3*c.KEY_A+c.KEY_W]=this.key2dirMap[1e3*c.KEY_W+c.KEY_A]=l(-1,1),this.key2dirMap[1e3*c.KEY_D+c.KEY_W]=this.key2dirMap[1e3*c.KEY_W+c.KEY_D]=l(1,1),this.key2dirMap[1e3*c.KEY_A+c.KEY_S]=this.key2dirMap[1e3*c.KEY_S+c.KEY_A]=l(-1,-1),this.key2dirMap[1e3*c.KEY_D+c.KEY_S]=this.key2dirMap[1e3*c.KEY_S+c.KEY_D]=l(1,-1),this.key2dirMap[1e3*c.KEY_A+c.KEY_D]=this.key2dirMap[c.KEY_D],this.key2dirMap[1e3*c.KEY_D+c.KEY_A]=this.key2dirMap[c.KEY_A],this.key2dirMap[1e3*c.KEY_W+c.KEY_S]=this.key2dirMap[c.KEY_S],this.key2dirMap[1e3*c.KEY_S+c.KEY_W]=this.key2dirMap[c.KEY_W]);var e=this.keys[this.keys.length-1]||0,t=this.keys[this.keys.length-2]||0,i=this.key2dirMap[1e3*t+e];this.moveDir.x=i.x,this.moveDir.z=i.y},t}(u)).prototype,"moveSpeed",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),k=t(S.prototype,"moveSpeedShiftScale",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),M=t(S.prototype,"damp",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),D=t(S.prototype,"rotateSpeed",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Y=S))||Y));s._RF.pop()}}}));

System.register("chunks:///_virtual/GlobalConst.ts",["cc"],(function(e){var n,t,i,r,a;return{setters:[function(e){n=e.cclegacy,t=e.Vec3,i=e.Vec2,r=e.mat4,a=e.geometry}],execute:function(){n._RF.push({},"75dd9YcQs9EfYi9NYLJtFBx","GlobalConst",void 0);var c=e("GlobalConst",(function(){}));c.interruptMapOp=!1,c.interruptBuildingOp=!1,c.selectBuilding=!1,c.cameraMoveDir=new t,c.camera=void 0,c.mapPanel=void 0,c.mapGridWidth=2,c.mapGridHeight=2;e("v2_1",new i),e("v2_2",new i),e("v2_3",new i),e("v2_4",new i),e("v3_1",new t),e("v3_2",new t),e("v3_3",new t),e("worldMatrix",r()),e("ray",new a.Ray);n._RF.pop()}}}));

System.register("chunks:///_virtual/Handler.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"b7951vWUg1Cab1Mz3k97c66","Handler",void 0);var s=t("Handler",function(){function t(t,i,s,e){void 0===t&&(t=null),void 0===i&&(i=null),void 0===s&&(s=null),void 0===e&&(e=!1),this.caller=void 0,this.method=void 0,this.args=void 0,this.once=!1,this._id=0,this.setTo(t,i,s,e)}var i=t.prototype;return i.setTo=function(i,s,e,h){return void 0===h&&(h=!1),this._id=t._gid++,this.caller=i,this.method=s,this.args=e,this.once=h,this},i.run=function(){if(null==this.method)return null;var t=this._id,i=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),i},i.runWith=function(t){if(null==this.method)return null;var i=this._id;if(null==t)var s=this.method.apply(this.caller,this.args);else s=this.args||t.unshift?this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t):this.method.call(this.caller,t);return this._id===i&&this.once&&this.recover(),s},i.clear=function(){return this.caller=null,this.method=null,this.args=null,this},i.recover=function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))},t.create=function(i,s,e,h){return void 0===e&&(e=null),void 0===h&&(h=!0),t._pool.length?t._pool.pop().setTo(i,s,e,h):new t(i,s,e,h)},t}());s._pool=[],s._gid=1,i._RF.pop()}}}));

System.register("chunks:///_virtual/IOperateHardwareHandler.ts",["cc"],(function(){var e;return{setters:[function(r){e=r.cclegacy}],execute:function(){e._RF.push({},"f6a21rN9uxAU5Fx4PqPDqqJ","IOperateHardwareHandler",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/IOperateLogic.ts",["cc"],(function(){var c;return{setters:[function(e){c=e.cclegacy}],execute:function(){c._RF.push({},"03065wySclLxJA2rcU62uYr","IOperateLogic",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/localConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./csvManager.ts","./resourceUtil.ts"],(function(n){var t,e,a,r,i,c;return{setters:[function(n){t=n.createClass},function(n){e=n.cclegacy,a=n._decorator,r=n.resources},function(n){i=n.CSVManager},function(n){c=n.ResourceUtil}],execute:function(){var o,s;e._RF.push({},"59035K8G6pLXr+kHdpKU40r","localConfig",void 0);var u=a.ccclass;a.property,n("LocalConfig",u("LocalConfig")(((s=function(){function n(){this._csvManager=i.instance,this._callback=new Function,this._currentLoad=0,this._cntLoad=0}var e=n.prototype;return e.loadConfig=function(n){this._callback=n,this._loadCSV()},e._loadCSV=function(){var n=this;r.loadDir("datas",(function(t,e){if(!t){var a=e.filter((function(n){return".bat"!==n._native&&".md"!==n._native}));n._cntLoad=a.length,a.length?a.forEach((function(t,e,a){c.getTextData(t.name,(function(e,a){n._csvManager.addTable(t.name,a),n._tryToCallbackOnFinished()}))})):n._tryToCallbackOnFinished()}}))},e.queryOne=function(n,t,e){return this._csvManager.queryOne(n,t,e)},e.queryByID=function(n,t){return this._csvManager.queryByID(n,t)},e.getTable=function(n){return this._csvManager.getTable(n)},e.getTableArr=function(n){return this._csvManager.getTableArr(n)},e.queryAll=function(n,t,e){return this._csvManager.queryAll(n,t,e)},e.queryIn=function(n,t,e){return this._csvManager.queryIn(n,t,e)},e.queryByCondition=function(n,t){return this._csvManager.queryByCondition(n,t)},e._tryToCallbackOnFinished=function(){this._callback&&(this._currentLoad++,this._currentLoad>=this._cntLoad&&this._callback())},t(n,null,[{key:"instance",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}())._instance=void 0,o=s))||o);e._RF.pop()}}}));

System.register("chunks:///_virtual/Log.ts",["cc"],(function(n){var o;return{setters:[function(n){o=n.cclegacy}],execute:function(){o._RF.push({},"9163f81r49G3JuniIuPFAc2","Log",void 0);n("Log",function(){function n(){}return n.log=function(){var n;(n=console).log.apply(n,arguments)},n.warn=function(){var n;(n=console).warn.apply(n,arguments)},n.error=function(){var n;(n=console).error.apply(n,arguments)},n}());o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./GlobalConst.ts","./MapMgr.ts","./OperateComp.ts","./BuildingComp.ts","./CameraControllerComp.ts","./FreeCamera.ts","./MapOperateComp.ts","./TestScreenInputComp.ts","./BuildingData.ts","./EnumIndex.ts","./Handler.ts","./Log.ts","./csv2json.ts","./csvManager.ts","./localConfig.ts","./poolManager.ts","./resourceUtil.ts","./storageManager.ts","./tips.ts","./uiManager.ts","./util.ts","./MsgEvent.ts","./msg.ts","./BuildingOperateLogic.ts","./IOperateHardwareHandler.ts","./IOperateLogic.ts","./MapOperateLogic.ts","./res.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MapMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConst.ts"],(function(t){var e,n,o,i,r,s,a,h,d,c,u,l,p;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy,o=t.Quat,i=t.Vec3,r=t.BoxCollider,s=t.Line,a=t.v3,h=t.geometry,d=t.MeshRenderer},function(t){c=t.v3_1,u=t.ray,l=t.GlobalConst,p=t.worldMatrix}],execute:function(){n._RF.push({},"af2dcNOMtxGLauFmWs6oZMc","MapMgr",void 0);new o;var f=new i;t("MapMgr",function(){function t(){this._node=void 0,this._meshRender=void 0}var n=t.prototype;return n.graphicsMapLine=function(){var t=this.node,e=t.getComponent(r),n=t.getComponentInChildren(s);c.set(e.worldBounds.halfExtents);for(var o=[],i=0;i<100;i++)o.push(a(i,.2,i)),o.push(a(-i,.2,i));n.positions=o},n.calculateHitPoint=function(t,e){this._node||this.node,l.camera.screenPointToRay(t.x,t.y,u);var n=h.intersect.rayModel(u,this._meshRender.model);return!!n&&(u.computeHit(f,n),e&&e.set(f),!0)},n.getHitPointToGrid=function(t,e){if(this.calculateHitPoint(t,f)){this.node.inverseTransformPoint(c,f);var n=this.node.scale,o=l.mapGridWidth/n.x,i=l.mapGridHeight/n.z;return e.x=Math.floor(c.x/o),e.y=Math.floor(c.z/i),!0}return!1},n.getHitPointToGridPosition=function(t,e,n){return!!this.calculateHitPoint(t,f)&&(this._setMapPos(e,n),!0)},n._setMapPos=function(t,e){this.node.inverseTransformPoint(c,f);var n=this.node.scale,o=l.mapGridWidth/n.x,r=l.mapGridHeight/n.z;e.x=Math.floor(c.x/o),e.y=Math.floor(c.z/r),t.x=(e.x+.5)*o,t.y=t.y,t.z=(e.y+.5)*r,this.node.getWorldMatrix(p),i.transformMat4(t,t,p)},e(t,[{key:"node",get:function(){return this._node||(this._node=l.mapPanel),this._meshRender||(this._meshRender=this._node.getComponent(d)),this._node}}],[{key:"ins",get:function(){return this._ins||(this._ins=new t)}}]),t}())._ins=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/MapOperateComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConst.ts","./util.ts","./MsgEvent.ts","./msg.ts","./MapMgr.ts"],(function(t){var i,e,o,n,s,r,a,h,c,l,_,u,p,d,P,m,y,f,g,R,v,x,M,A;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,r=t._decorator,a=t.Quat,h=t.Vec3,c=t.Node,l=t.geometry,_=t.Vec2,u=t.MeshRenderer,p=t.screen,d=t.misc,P=t.Component},function(t){m=t.GlobalConst,y=t.v3_1,f=t.v3_2,g=t.v3_3,R=t.worldMatrix},function(t){v=t.Util},function(t){x=t.MsgEvent},function(t){M=t.Msg},function(t){A=t.MapMgr}],execute:function(){var w,T,C,O,b,D,z,E;s._RF.push({},"8fcd9kmlGlNiZX0iC86AXU1","MapOperateComp",void 0);var H=r.ccclass,U=r.property,S=new a,G=new h;t("MapOperateComp",(w=H("MapOperateComp"),T=U({slide:!0,range:[.05,.5,.01]}),C=U(c),w(((E=function(t){function i(){for(var i,e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return(i=t.call.apply(t,[this].concat(s))||this)._eulerP=new h,i._cameraRay=new l.Ray,i._centerPoint=new h,i._position=new h,o(i,"damp",D,n(i)),o(i,"sphere",z,n(i)),i._rotaAxisDirty=!0,i._moveDirty=!0,i._velocity=new h,i._speedScale=1,i._meshRender=void 0,i._preHit3DPoint=new h,i._noteTouchePoint=new _,i._rotaRatio=.5,i.startAngle=0,i.originPos=new h,i}e(i,t);var s=i.prototype;return s.onLoad=function(){i.ins=this,m.mapPanel=this.node,this._meshRender=this.node.getComponent(u),h.copy(this._eulerP,this.node.eulerAngles),h.copy(this._position,this.node.position)},s.onEnable=function(){this.calculateRotaAxis(),M.on(x.OP_TOUCH_ROTA,this.rotaView.bind(this)),M.on(x.OP_TOUCH_MOVE,this.moveView.bind(this)),M.on(x.OP_TOUCH_MOVE_MAP,this.noteMoveTochePoint.bind(this)),M.on(x.OP_RESET_CLICK_POINT,this._updateHitPoint.bind(this)),A.ins.graphicsMapLine()},s.onDisable=function(){M.off(x.OP_TOUCH_ROTA)},s._updateHitPoint=function(t){A.ins.calculateHitPoint(t,G),this._preHit3DPoint.set(G)},s.noteMoveTochePoint=function(t){this._moveDirty=!0,this._noteTouchePoint.set(t)},s.moveMap=function(t){this._moveDirty&&(this._moveDirty=!1,A.ins.calculateHitPoint(t,G)&&(y.set(G),h.subtract(f,y,this._preHit3DPoint),this._preHit3DPoint.set(y),this._velocity.add(f),v.createSphere(this.node.parent,.5,y)))},s.resetRotaAxisDirty=function(){this._rotaAxisDirty=!0},s.moveView=function(t){this.resetRotaAxisDirty()},s.calculateRotaAxis=function(){if(this._rotaAxisDirty){this._rotaAxisDirty=!1,m.camera.screenPointToRay(p.windowSize.width/2,p.windowSize.height/2,this._cameraRay);var t=l.intersect.rayModel(this._cameraRay,this._meshRender.model);t&&this._cameraRay.computeHit(this._centerPoint,t),this.sphere&&this.sphere.setPosition(this._centerPoint),this.startAngle=0,this.node.getPosition(this.originPos)}},s.rotaView=function(t){this.calculateRotaAxis();var i=t.x,e=t.y;this.setRotaCamera(i),this.setRotaPos(e)},s.setRotaCamera=function(t){return this.setRotaCamera2(t)},s.setRotaCamera2=function(t){var i=m.camera.node,e=i.eulerAngles;(e.x+t<-89||e.x+t>-30)&&(console.log("超过极限了"),e.x+t<-89&&(t=-89-e.x),e.x+t>-30&&(t=-30-e.x),console.log("解锁:eulerAngles.x + x : "+e.x+t));var o=i.parent.worldPosition;h.subtract(y,o,this._centerPoint);var n=t,s=d.degreesToRadians(n);S.set(),a.rotateAround(S,S,i.right,s),h.transformQuat(y,y,S),g.set(this._centerPoint.x+y.x,this._centerPoint.y+y.y,y.z+this._centerPoint.z),M.emit(x.UPDATE_CAMERA_POSITION,g),i.lookAt(this._centerPoint),M.emit(x.UPDATE_CAMERA_EULER_ANGLE,i.eulerAngles)},s.setRotaPos=function(t){t*=this._rotaRatio,this._eulerP.y-=t,this.startAngle+=t,h.subtract(y,this.originPos,this._centerPoint);var i=y,e=d.degreesToRadians(this.startAngle),o=Math.cos(e),n=Math.sin(e),s=i.x*o-i.z*n,r=i.x*n+i.z*o;this._position.set(s+this._centerPoint.x,this._position.y,r+this._centerPoint.z)},s.update=function(t){this.moveMap(this._noteTouchePoint);var i=Math.min(t/this.damp,1);this.updateRotation(i),this._upadtePosition(),h.lerp(y,this.node.getPosition(),this._position,i),this.node.setPosition(y)},s._upadtePosition=function(){h.scaleAndAdd(this._position,this._position,this._velocity,this._speedScale),this._velocity.set()},s.updateRotation=function(t){a.fromEuler(S,this._eulerP.x,this._eulerP.y,this._eulerP.z),a.slerp(S,this.node.rotation,S,t),this.node.rotation=S},s._calculateRotaPos2=function(t){this._eulerP.y+=t,this.node.getPosition(y),h.subtract(g,y,this._centerPoint),h.rotateY(f,g,h.UP,t),this._position.set(this._centerPoint.add(f))},s._calculateRotaPos=function(t){this._eulerP.y+=t;var i=this.node.getPosition(y).subtract(this._centerPoint),e=d.degreesToRadians(this._eulerP.y),o=Math.cos(e),n=Math.sin(e),s=i.x*o-i.z*n,r=i.x*n+i.z*o;this._position.set(s+this._centerPoint.x,this._position.y,r+this._centerPoint.z)},s._testMatrixToMap=function(t){return h.transformInverseRTS(y,G,this.node.rotation,this.node.position,h.ONE),console.log("hitpointx:"+y.x+" hitpointy:"+y.y+" hitpointz:"+y.z),t.x=(Math.floor(y.x/m.mapGridWidth)+.5)*m.mapGridWidth,t.y=t.y,t.z=(Math.floor(y.z/m.mapGridHeight)+.5)*m.mapGridHeight,this.node.getWorldMatrix(R),h.transformMat4(t,t,R),t.divide(this.node.scale),!0},i}(P)).ins=void 0,D=i((b=E).prototype,"damp",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.2}}),z=i(b.prototype,"sphere",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=b))||O));s._RF.pop()}}}));

System.register("chunks:///_virtual/MapOperateLogic.ts",["cc","./GlobalConst.ts","./CameraControllerComp.ts","./MsgEvent.ts","./msg.ts","./util.ts","./MapOperateComp.ts"],(function(t){var e,o,n,i,c,r,a,s,u,l,g,_,v,p,O,M;return{setters:[function(t){e=t.cclegacy,o=t.Vec2,n=t.misc,i=t.Vec3},function(t){c=t.GlobalConst,r=t.v2_2,a=t.v2_1,s=t.v2_3,u=t.v2_4,l=t.v3_1,g=t.v3_2},function(t){_=t.CameraControllerComp},function(t){v=t.MsgEvent},function(t){p=t.Msg},function(t){O=t.Util},function(t){M=t.MapOperateComp}],execute:function(){e._RF.push({},"7dd7bxhQXlIMaIGgcucLKGL","MapOperateLogic",void 0);var h=.05;t("MapOperateLogic",function(){function t(){this.rotaWheelSpeed=.1,this.touchDir=new o,this._continueMoveDirty=!1}var e=t.prototype;return e.onTouchStart=function(t){if(c.interruptMapOp)return console.warn("中断操作中...............");this._continueMoveDirty=!1;var e=t.getAllTouches();_.test(t.getLocation()),e.length>1?c.selectBuilding=!1:(e[0].getLocation(r),p.emit(v.OP_RESET_CLICK_POINT,r))},e.onTouchMove=function(t){if(c.interruptMapOp)return console.warn("中断操作中...............");var e=t.getAllTouches();if(e.length>1){c.selectBuilding=!1,e[0].getPreviousLocation(a),e[1].getPreviousLocation(r);var _=o.distance(a,r);o.subtract(s,r,a),e[0].getPreviousLocation(u).subtract(e[1].getPreviousLocation(a)),e[0].getLocation(a).subtract(e[1].getLocation(r));var M=n.radiansToDegrees(u.signAngle(a)),C=e[0].getDelta(r).y,L=e[1].getDelta(a).y;e[0].getLocation(a),e[1].getLocation(r);var T,f=o.distance(a,r),m=0;L>0&&C>0?m=Math.min(L,C):L<0&&C<0&&(m=Math.max(L,C)),T=_-f,r.set(m,-M),p.emit(v.OP_TOUCH_SCALE,.1*T),p.emit(v.OP_TOUCH_ROTA,r)}else{if(this._continueMoveDirty)return void(this._continueMoveDirty=!1);e[0].getPreviousLocation(a),O.getScreenToWorld(a,l,h),e[0].getLocation(r),O.getScreenToWorld(r,g,h),i.subtract(g,l,g),a.set(g.x,g.z),p.emit(v.OP_TOUCH_MOVE,a),p.emit(v.OP_TOUCH_MOVE_MAP,r)}},e.onTouchEnd=function(t){if(c.interruptMapOp)console.warn("中断操作中...............");else{var e=t.getAllTouches();if(e.length>=1){e[0].getLocation(r),p.emit(v.OP_RESET_CLICK_POINT,r),O.getScreenToWorld(r,g,h),p.emit(v.OP_TOUCH_MOVE_MAP,r);var o=M.ins._velocity;console.log("MapOperateComp.ins._velocity x:"+o.x+" y:"+o.y+" z:"+o.z)}this._continueMoveDirty=!0,p.emit(v.OP_TOUCH_MOVE,a.set(0,0))}},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/msg.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"67a38mOSWNH2YAjqnIAO/fp","msg",void 0),t("Msg",function(){function t(){}return t.on=function(t,i){this._map[t]||(this._map[t]=[]),this._map[t].push(i)},t.bind=function(t,i,n){i=i.bind(n),this._map[t]||(this._map[t]=[]),this._map[t].push(i)},t.off=function(t,i){if(null===i)this._map[t]=[];else{var n=this._map[t].indexOf(i);this._map[t].splice(n,1)}},t.emit=function(t,i){var n=this._map[t];n&&n.forEach((function(t){t(i)}))},t}())._map={},i._RF.pop()}}}));

System.register("chunks:///_virtual/MsgEvent.ts",["cc"],(function(_){var O;return{setters:[function(_){O=_.cclegacy}],execute:function(){O._RF.push({},"7e300yrQ2RPB7rFbIG+tqVu","MsgEvent",void 0);_("MsgEvent",function(_){return _.OP_TOUCH_MOVE="OP_TOUCH_MOVE",_.OP_TOUCH_SCALE="OP_TOUCH_SCALE",_.OP_TOUCH_ROTA="OP_TOUCH_ROTA",_.OP_RESET_CLICK_POINT="OP_RESET_CLICK_POINT",_.OP_TOUCH_MOVE_MAP="OP_TOUCH_MOVE_MAP",_.UPDATE_CAMERA_POSITION="UPDATE_CAMERA_POSITION",_.UPDATE_CAMERA_EULER_ANGLE="UPDATE_CAMERA_EULER_ANGLE",_}({}));O._RF.pop()}}}));

System.register("chunks:///_virtual/OperateComp.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GlobalConst.ts","./MsgEvent.ts","./msg.ts","./MapOperateComp.ts","./MapOperateLogic.ts","./BuildingOperateLogic.ts"],(function(e){var t,i,o,n,s,r,a,p,h,E,c,u,y,_;return{setters:[function(e){t=e.inheritsLoose},function(e){i=e.cclegacy,o=e._decorator,n=e.Input,s=e.input,r=e.KeyCode,a=e.v2,p=e.Component},function(e){h=e.GlobalConst},function(e){E=e.MsgEvent},function(e){c=e.Msg},function(e){u=e.MapOperateComp},function(e){y=e.MapOperateLogic},function(e){_=e.BuildingOperateLogic}],execute:function(){var d;i._RF.push({},"bc1abqVC6pJKoP20j8W1PlZ","OperateComp",void 0);var K=o.ccclass;o.property,e("OperateComp",K("OperateComp")(d=function(e){function i(){for(var t,i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];return(t=e.call.apply(e,[this].concat(o))||this).rotaWheelSpeed=.1,t.mapOperateLogic=new y,t.buildingOperateLogic=void 0,t.keys=[],t.key2dirMap=null,t}t(i,e);var o=i.prototype;return o.onLoad=function(){var e=this.getTarget();this.buildingOperateLogic=new _(this),e.on(n.EventType.MOUSE_WHEEL,this.onMouseWheel,this),e.on(n.EventType.TOUCH_START,this.onTouchStart,this),e.on(n.EventType.TOUCH_MOVE,this.onTouchMove,this),e.on(n.EventType.TOUCH_END,this.onTouchEnd,this),e.on(n.EventType.TOUCH_CANCEL,this.onTouchEnd,this),e.on(n.EventType.KEY_DOWN,this.onKeyDown,this),e.on(n.EventType.KEY_UP,this.onKeyUp,this)},o.onDestroy=function(){var e=this.getTarget();e.off(n.EventType.MOUSE_WHEEL,this.onMouseWheel,this),e.off(n.EventType.TOUCH_START,this.onTouchStart,this),e.off(n.EventType.TOUCH_MOVE,this.onTouchMove,this),e.off(n.EventType.TOUCH_END,this.onTouchEnd,this),e.off(n.EventType.TOUCH_CANCEL,this.onTouchEnd,this),e.off(n.EventType.KEY_DOWN,this.onKeyDown,this),e.off(n.EventType.KEY_UP,this.onKeyUp,this)},o.getTarget=function(){return s},o.onMouseWheel=function(e){if(h.interruptMapOp)return console.warn("中断操作中...............");console.log("滚轮滚动的参数 getScrollX："+e.getScrollX()+"  getScrollY:"+e.getScrollY());var t=-e.getScrollY()*this.rotaWheelSpeed*.1;c.emit(E.OP_TOUCH_SCALE,t)},o.onTouchStart=function(e){this.mapOperateLogic.onTouchStart(e),this.buildingOperateLogic.onTouchStart(e)},o.onTouchMove=function(e){this.buildingOperateLogic.onTouchMove(e),this.buildingOperateLogic.checkMoveBuild()||this.mapOperateLogic.onTouchMove(e)},o.onTouchEnd=function(e){this.buildingOperateLogic.onTouchEnd(e),this.mapOperateLogic.onTouchEnd(e)},o.onKeyDown=function(e){if(h.interruptMapOp)return console.warn("中断操作中...............");var t=e.keyCode;t!=r.KEY_A&&t!=r.KEY_S&&t!=r.KEY_D&&t!=r.KEY_W||-1==this.keys.indexOf(t)&&(this.keys.push(t),this.updateDirection()),t==r.KEY_Q?u.ins.setRotaCamera(1):t==r.KEY_E&&u.ins.setRotaCamera(-1)},o.onKeyUp=function(e){if(h.interruptMapOp)return console.warn("中断操作中...............");var t=e.keyCode;if(t==r.KEY_A||t==r.KEY_S||t==r.KEY_D||t==r.KEY_W){var i=this.keys.indexOf(t);-1!=i&&(this.keys.splice(i,1),this.updateDirection())}t==r.KEY_Q||r.KEY_E},o.updateDirection=function(){null==this.key2dirMap&&(this.key2dirMap={},this.key2dirMap[0]=a(0,0),this.key2dirMap[r.KEY_A]=a(-1,0),this.key2dirMap[r.KEY_D]=a(1,0),this.key2dirMap[r.KEY_W]=a(0,1),this.key2dirMap[r.KEY_S]=a(0,-1),this.key2dirMap[1e3*r.KEY_A+r.KEY_W]=this.key2dirMap[1e3*r.KEY_W+r.KEY_A]=a(-1,1),this.key2dirMap[1e3*r.KEY_D+r.KEY_W]=this.key2dirMap[1e3*r.KEY_W+r.KEY_D]=a(1,1),this.key2dirMap[1e3*r.KEY_A+r.KEY_S]=this.key2dirMap[1e3*r.KEY_S+r.KEY_A]=a(-1,-1),this.key2dirMap[1e3*r.KEY_D+r.KEY_S]=this.key2dirMap[1e3*r.KEY_S+r.KEY_D]=a(1,-1),this.key2dirMap[1e3*r.KEY_A+r.KEY_D]=this.key2dirMap[r.KEY_D],this.key2dirMap[1e3*r.KEY_D+r.KEY_A]=this.key2dirMap[r.KEY_A],this.key2dirMap[1e3*r.KEY_W+r.KEY_S]=this.key2dirMap[r.KEY_S],this.key2dirMap[1e3*r.KEY_S+r.KEY_W]=this.key2dirMap[r.KEY_W]);var e=this.keys[this.keys.length-1]||0,t=this.keys[this.keys.length-2]||0,i=this.key2dirMap[1e3*t+e];h.cameraMoveDir.x=i.x,h.cameraMoveDir.z=i.y},i}(p))||d);i._RF.pop()}}}));

System.register("chunks:///_virtual/poolManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,e,n,i,r;return{setters:[function(t){o=t.createClass},function(t){e=t.cclegacy,n=t._decorator,i=t.instantiate,r=t.NodePool}],execute:function(){var a,c;e._RF.push({},"a63d5jVC8VJLKN1xodEUrZZ","poolManager",void 0);var s=n.ccclass;n.property,t("PoolManager",s("PoolManager")(((c=function(){function t(){this._dictPool={},this._dictPrefab={}}var e=t.prototype;return e.getNode=function(t,o){var e=t.name;t.position||(e=t.data.name),this._dictPrefab[e]=t;var n=null;if(this._dictPool.hasOwnProperty(e)){var a=this._dictPool[e];n=a.size()>0?a.get():i(t)}else{var c=new r;this._dictPool[e]=c,n=i(t)}return n.parent=o,n.active=!0,n},e.putNode=function(t){if(t){var o=t.name,e=null;this._dictPool.hasOwnProperty(o)?e=this._dictPool[o]:(e=new r,this._dictPool[o]=e),e.put(t)}},e.clearPool=function(t){this._dictPool.hasOwnProperty(t)&&this._dictPool[t].clear()},e.prePool=function(t,o){var e=t.name,n=new r;this._dictPool[e]=n;for(var a=0;a<o;a++){var c=i(t);n.put(c)}},e.destroyNode=function(t){t.destroy()},o(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=void 0,a=c))||a);e._RF.pop()}}}));

System.register("chunks:///_virtual/res.ts",["cc","./msg.ts"],(function(t){var o,i,n,e,s,a,d,c,l,r,u,f,h,m,D,S,_,g,v,A,p;return{setters:[function(t){o=t.cclegacy,i=t.resources,n=t.error,e=t.JsonAsset,s=t.TextAsset,a=t.Prefab,d=t.Texture2D,c=t.ImageAsset,l=t.SpriteFrame,r=t.SpriteAtlas,u=t.EffectAsset,f=t.AudioClip,h=t.AnimationClip,m=t.Mesh,D=t.Material,S=t.Skeleton,_=t.SceneAsset,g=t.Vec3,v=t.instantiate,A=t.director},function(t){p=t.Msg}],execute:function(){o._RF.push({},"fea4boABrlJL6BAxHDZ2QxF","res",void 0),t("Res",function(){function t(){}return t.load=function(o,e,s){this.count++,i.load(o,e,(function(i,e){i&&(n(o,i.message||i),p.emit("msg_res_error")),s&&s(i,e),t.count--,p.emit("msg_check_res_cache_end")}))},t.loadJson=function(t,o){this.load(t,e,o)},t.loadTxt=function(t,o){this.load(t,s,o)},t.loadPrefab=function(t,o){this.load(t,a,o)},t.loadTex2D=function(t,o){this.load(t,d,o)},t.loadImage=function(t,o){this.load(t,c,o)},t.loadSprite=function(t,o){this.load(t,l,o)},t.loadSpriteAtlas=function(t,o){this.load(t,r,o)},t.loadEffect=function(t,o){this.load(t,u,o)},t.loadAudio=function(t,o){this.load(t,f,o)},t.loadAnimationClip=function(t,o){this.load(t,h,o)},t.loadMesh=function(t,o){this.load(t,m,o)},t.loadMateiral=function(t,o){this.load(t,D,o)},t.loadSkeleton=function(t,o){this.load(t,S,o)},t.loadScene=function(t,o){this.load(t,_,o)},t.inst=function(t,o,i){void 0===o&&(o=void 0),void 0===i&&(i=g.ZERO);var n,e=v(t);void 0===o?null==(n=A.getScene())||n.addChild(e):e.setParent(o);return e.setPosition(i),e.setScale(g.ONE),e},t.instNode=function(t,o,i){void 0===o&&(o=void 0),void 0===i&&(i=g.ZERO);var n,e=v(t);void 0===o?null==(n=A.getScene())||n.addChild(e):e.setParent(o);return e.setPosition(i),e.setScale(g.ONE),e},t.loadDir=function(o,e,s){this.count++,i.loadDir(o,e,(function(o,i){o&&(n(o.message||o),p.emit("msg_res_error")),s&&s(o,i),t.count--,p.emit("msg_check_res_cache_end")}))},t.loadDirJson=function(t,o){this.loadDir(t,e,o)},t.loadDirPrefab=function(t,o){this.loadDir(t,a,o)},t.loadDirText=function(t,o){this.loadDir(t,s,o)},t.loadDirSprite=function(t,o){this.loadDir(t,l,o)},t.loadDirSound=function(t,o){this.loadDir(t,f,o)},t}()).count=0,o._RF.pop()}}}));

System.register("chunks:///_virtual/resourceUtil.ts",["cc"],(function(e){var n,o,t,r,i,a,s,l,f,u;return{setters:[function(e){n=e.cclegacy,o=e._decorator,t=e.resources,r=e.error,i=e.Prefab,a=e.SpriteFrame,s=e.Texture2D,l=e.instantiate,f=e.find,u=e.isValid}],execute:function(){var c;n._RF.push({},"fa19fO0gElEdLxcXHE+z5w2","resourceUtil",void 0);var d=o.ccclass;e("ResourceUtil",d("ResourceUtil")(c=function(){function e(){}return e.loadRes=function(e,n,o){void 0===o&&(o=function(){}),t.load(e,(function(e,n){if(e)return r(e.message||e),void o(e,n);o&&o(null,n)}))},e.loadEffectRes=function(e){var n=this;return new Promise((function(o,t){n.loadRes("prefab/effect/"+e,i,(function(n,r){if(n)return console.error("effect load failed",e),void(t&&t());o&&o(r)}))}))},e.loadModelRes=function(e){var n=this;return new Promise((function(o,t){n.loadRes("prefab/model/"+e,i,(function(n,r){if(n)return console.error("model load failed",e),void(t&&t());o&&o(r)}))}))},e.loadModelResArr=function(e,n,o,r){var a=n.map((function(n){return e+"/"+n}));t.load(a,i,o,r)},e.loadSpriteFrameRes=function(e){var n=this;return new Promise((function(o,t){n.loadRes(e,a,(function(n,r){if(n)return console.error("spriteFrame load failed!",e,n),void(t&&t());var i=new s;i.image=r;var l=new a;l.texture=i,o&&o(l)}))}))},e.getMap=function(e,n){var o="map";o+=e>=100?e:e>=10?"0"+e:"00"+e,this.loadRes("map/config/"+o,null,(function(e,o){if(e)n(e,o);else{var t="";if(o._file){window.LZString&&(t=window.LZString.decompressFromEncodedURIComponent(o._file));var r=JSON.parse(t);n(null,r)}else if(o.text){window.LZString&&(t=window.LZString.decompressFromEncodedURIComponent(o.text));r=JSON.parse(t);n(null,r)}else o.json?n(null,o.json):n("failed")}}))},e.getMapObj=function(e,n,o,r){for(var a=[],s=0;s<n.length;s++)a.push("map/"+e+"/"+n[s]);t.load(a,i,o,r)},e.getUIPrefabRes=function(e,n){this.loadRes("prefab/ui/"+e,i,n)},e.createUI=function(e,n,o){this.getUIPrefabRes(e,(function(e,t){if(!e){var r=l(t);r.setPosition(0,0,0),o||(o=f("Canvas")),o.addChild(r),n&&n(null,r)}}))},e.getJsonData=function(e,n){this.loadRes("datas/"+e,null,(function(e,o){e?r(e.message||e):o.json?n(e,o.json):n("failed!!!")}))},e.getTextData=function(e,n){this.loadRes("datas/"+e,null,(function(e,o){if(e)r(e.message||e);else{var t=o.text;n(e,t)}}))},e.setSpriteFrame=function(e,n,o){this.loadRes(e+"/spriteFrame",a,(function(t,r){if(t)return console.error("set sprite frame failed! err:",e,t),void(o&&o(t));n&&u(n)&&(n.spriteFrame=r,o&&o(null))}))},e}())||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/storageManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./util.ts","./Log.ts"],(function(t){var a,s,e,n,i,o,r,c;return{setters:[function(t){a=t.createClass},function(t){s=t.cclegacy,e=t._decorator,n=t.sys,i=t.native,o=t.log},function(t){r=t.Util},function(t){c=t.Log}],execute:function(){var h,u;s._RF.push({},"cceeb1D6UhMyZpV/MY3r3+C","storageManager",void 0);var l=e.ccclass;e.property,t("StorageManager",l("StorageManager")(((u=function(){function t(){this._jsonData={},this._path=null,this._markSave=!1,this._saveTimer=-1}var s=t.prototype;return s.start=function(){var a,s=this;(this._jsonData={userId:""},this._path=this._getConfigPath(),n.isNative)?a=i.fileUtils.getValueMapFromFile(this._path)[t.KEY_CONFIG]:a=n.localStorage.getItem(t.KEY_CONFIG);if(a&&a.length){a.startsWith("@")&&(a=a.substring(1),a=r.decrypt(a));try{var e=JSON.parse(a);this._jsonData=e}catch(t){}}this._saveTimer=setInterval((function(){s.scheduleSave()}),5e3)},s.setConfigDataWithoutSave=function(t,a){var s=this._jsonData.userId;this._jsonData[s]?this._jsonData[s][t]=a:console.error("no account can not save")},s.setConfigData=function(t,a){this.setConfigDataWithoutSave(t,a),this._markSave=!0},s.getConfigData=function(t){var a=this._jsonData.userId;if(this._jsonData[a]){var s=this._jsonData[a][t];return s||""}return o("no account can not load"),""},s.setGlobalData=function(t,a,s){if(this._jsonData[t]==a)return c.log("有相同的数据了");this._jsonData[t]=a,s?this.save():this._markSave=!0},s.getGlobalData=function(t){return this._jsonData[t]},s.setUserId=function(t){this._jsonData.userId=t,this._jsonData[t]||(this._jsonData[t]={}),this.save()},s.getUserId=function(){return this._jsonData.userId},s.scheduleSave=function(){this._markSave&&this.save()},s.markModified=function(){this._markSave=!0},s.save=function(){var a=JSON.stringify(this._jsonData),s="@"+r.encrypt(a);if(this._markSave=!1,n.isNative){var e={};e[t.KEY_CONFIG]=s,i.fileUtils.writeToFile(e)}else{n.localStorage.setItem(t.KEY_CONFIG,s)}},s._getConfigPath=function(){var t=n.platform,a="";return t===n.OS.WINDOWS?a="src/conf":t===n.OS.LINUX?a="./conf":n.isNative?(a=i.fileUtils.getWritablePath(),a+="conf"):a="src/conf",a},a(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t,this._instance.start()),this._instance}}]),t}())._instance=void 0,u.KEY_CONFIG="template",h=u))||h);s._RF.pop()}}}));

System.register("chunks:///_virtual/TestScreenInputComp.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,o,r;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator,r=e.Component}],execute:function(){var c;n._RF.push({},"68a131kUu5EELNZWNvNNZPJ","TestScreenInputComp",void 0);var u=o.ccclass;o.property,e("TestScreenInputComp",u("TestScreenInputComp")(c=function(e){function n(){return e.apply(this,arguments)||this}return t(n,e),n.prototype.onLoad=function(){this.node.active=!1},n}(r))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/tips.ts",["./rollupPluginModLoBabelHelpers.js","cc","./poolManager.ts"],(function(t){var n,i,e,o,r,a,s,p,c,l;return{setters:[function(t){n=t.applyDecoratedDescriptor,i=t.inheritsLoose,e=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,s=t.LabelComponent,p=t.Animation,c=t.Component},function(t){l=t.PoolManager}],execute:function(){var u,f,h,d,v;r._RF.push({},"cefad8xjrFKMr/WQzfpXZOF","tips",void 0);var y=a.ccclass,g=a.property;t("Tips",(u=y("Tips"),f=g(s),u((v=n((d=function(t){function n(){for(var n,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=t.call.apply(t,[this].concat(r))||this,e(n,"lbTips",v,o(n)),n.targetPos=void 0,n._ani=void 0,n}i(n,t);var r=n.prototype;return r.onLoad=function(){this._ani=this.node.getComponent(p)},r.start=function(){},r.show=function(t,n){var i=this;this.lbTips.string=t,this._ani.on(p.EventType.FINISHED,(function(){l.instance.putNode(i.node),n&&n()})),this._ani.play()},n}(c)).prototype,"lbTips",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=d))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/uiManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./resourceUtil.ts","./poolManager.ts","./tips.ts"],(function(i){var t,e,a,n,o,s,r,p;return{setters:[function(i){t=i.createClass},function(i){e=i.cclegacy,a=i._decorator,n=i.isValid,o=i.find},function(i){s=i.ResourceUtil},function(i){r=i.PoolManager},function(i){p=i.Tips}],execute:function(){var h,c;e._RF.push({},"25e11uIK+hKspsO114TNPVO","uiManager",void 0);var u=a.ccclass;a.property,i("UIManager",u("UIManager")(((c=function(){function i(){this._dictSharedPanel={},this._dictLoading={},this._arrPopupDialog=[],this._showTipsTime=0,this.canvas=void 0}var e=i.prototype;return e.isDialogVisible=function(i){if(!this._dictSharedPanel.hasOwnProperty(i))return!1;var t=this._dictSharedPanel[i];return n(t)&&t.active&&t.parent},e.showDialog=function(i,t,e){var a=this;if(!this._dictLoading[i]){var r=i.lastIndexOf("/"),p=i.slice(r+1);if(t||(t=[]),this._dictSharedPanel.hasOwnProperty(i)){var h=this._dictSharedPanel[i];if(n(h)){h.parent=o("Canvas"),h.active=!0;var c=h.getComponent(p),u=h.getComponent(p.charAt(0).toUpperCase()+p.slice(1));if(c&&c.show)c.show.apply(c,t),e&&e(c);else{if(!u||!u.show)throw"查找不到脚本文件"+p;u.show.apply(u,t),e&&e(u)}return}}this._dictLoading[i]=!0,s.createUI(i,(function(n,o){var s=!1;if(a._dictLoading[i]||(s=!0),a._dictLoading[i]=!1,n)console.error(n);else{a._dictSharedPanel[i]=o;var r=o.getComponent(p),h=o.getComponent(p.charAt(0).toUpperCase()+p.slice(1));if(r&&r.show)r.show.apply(r,t),e&&e(r);else{if(!h||!h.show)throw"查找不到脚本文件"+p;h.show.apply(h,t),e&&e(h)}s&&a.hideDialog(i)}}))}},e.hideDialog=function(i,t){if(this._dictSharedPanel.hasOwnProperty(i)){var e=this._dictSharedPanel[i];if(e&&n(e)){var a=e.getComponent("animationUI");a?a.close((function(){e.parent=null,t&&"function"==typeof t&&t()})):(e.parent=null,t&&"function"==typeof t&&t())}else t&&"function"==typeof t&&t()}this._dictLoading[i]=!1},e.pushToPopupSeq=function(i,t,e){var a={panelPath:i,scriptName:t,param:e,isShow:!1};this._arrPopupDialog.push(a),this._checkPopupSeq()},e.insertToPopupSeq=function(i,t,e){var a={panelPath:t,param:e,isShow:!1};this._arrPopupDialog.splice(i,0,a)},e.shiftFromPopupSeq=function(i){var t=this;this.hideDialog(i,(function(){t._arrPopupDialog[0]&&t._arrPopupDialog[0].panelPath===i&&(t._arrPopupDialog.shift(),t._checkPopupSeq())}))},e._checkPopupSeq=function(){if(this._arrPopupDialog.length>0){var i=this._arrPopupDialog[0];i.isShow||(this.showDialog(i.panelPath,i.param),this._arrPopupDialog[0].isShow=!0)}},e.showTips=function(i,t){var e=this,a=String(i),n=function(){e._showTipsAni(a,t)},o=Date.now();if(o-this._showTipsTime<800){var s=800-(o-this._showTipsTime);setTimeout((function(){n()}),s),this._showTipsTime=o+s}else n(),this._showTipsTime=o},e._showTipsAni=function(i,t){var e=this;s.getUIPrefabRes("TipsItem",(function(a,n){a||r.instance.getNode(n,e.canvas||o("Canvas")).getComponent(p).show(i,t)}))},t(i,null,[{key:"instance",get:function(){return this._instance||(this._instance=new i),this._instance}}]),i}())._instance=void 0,h=c))||h);e._RF.pop()}}}));

System.register("chunks:///_virtual/util.ts",["cc","./GlobalConst.ts"],(function(e){var t,r,n,o,a,i,f,u,h,c,g,l;return{setters:[function(e){t=e.cclegacy,r=e._decorator,n=e.v3,o=e.Material,a=e.builtinResMgr,i=e.tween,f=e.Vec2,u=e.misc,h=e.Node,c=e.Primitive,g=e.MeshRenderer},function(e){l=e.GlobalConst}],execute:function(){var d;t._RF.push({},"2f0050MiR1EQI/deROKMmBb","util",void 0);var s=r.ccclass,v=(r.property,n()),m=new o;!function(e){e._uuid="TestSphere01",e.initialize({effectName:"builtin-unlit",defines:{USE_TEXTURE:!0,USE_INSTANCING:!0}});var t=a.get("white-texture");e.setProperty("mainTexture",t,0)}(m);e("Util",s("Util")(d=function(){function e(){}return e.clone=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var r in e.constructor===Array&&(t=[]),e)e.hasOwnProperty(r)&&(t[r]=this.clone(e[r]));return t},e.objectToArray=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t},e.arrayToObject=function(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&e[n][t]&&(r[e[n][t]]=e[n]);return r},e.getWeightRandIndex=function(e,t){for(var r=Math.floor(Math.random()*t),n=0,o=0;o<e.length&&!(r<(n+=e[o]));o++);return o},e.getRandomNFromM=function(e,t){for(var r=[],n=0,o=0;o<t&&!(o>=e+1);){n=this.getRandomInt(0,e);for(var a=0,i=0;i<o;i++)if(r[i]===n){a=1;break}0===a&&(r[o]=n,o++)}return r},e.getRandomInt=function(e,t){var r=Math.random()*(t-e+1)+e;return Math.floor(r)},e.getStringLength=function(e){for(var t=e,r=0,n=0,o=t.length;n<o;n++){r+=t.charCodeAt(n)<=255?1:2}return Math.ceil(r/2)},e.isEmptyObject=function(e){var t=!0;if(e&&e.constructor===Object){for(var r in e)if(e.hasOwnProperty(r)){t=!1;break}}else t=!1;return t},e.isNewDay=function(e){var t=new Date(e),r=new Date,n=t.getYear(),o=t.getMonth(),a=t.getDate(),i=r.getYear(),f=r.getMonth(),u=r.getDate();return i>n||(f>o||u>a)},e.getPropertyCount=function(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r},e.difference=function(e,t){var r=[];if(e.constructor!==Array||t.constructor!==Array)return r;for(var n=e.length,o=0;o<n;o++)-1===t.indexOf(e[o])&&r.push(e[o]);return r},e._stringToArray=function(e){var t,r="\\ufe0e\\ufe0f",n="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",o=RegExp("[\\u200d\\ud800-\\udfff"+n+r+"]"),a="\\ud83c[\\udffb-\\udfff]",i="[\\ufe0e\\ufe0f]?",f="["+n+"]",u="(?:"+f+"|"+a+")"+"?",h="[\\ud800-\\udfff]",c="[^\\ud800-\\udfff]",g="(?:\\ud83c[\\udde6-\\uddff]){2}",l="[\\ud800-\\udbff][\\udc00-\\udfff]",d=i+u+("(?:\\u200d(?:"+[c,g,l].join("|")+")"+i+u+")*"),s="(?:"+[c+f+"?",f,g,l,h].join("|")+")",v=RegExp(a+"(?="+a+")|"+s+d,"g");return t=e,o.test(t)?function(e){return e.match(v)||[]}(e):function(e){return e.split("")}(e)},e.simulationUUID=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.trim=function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},e.isNowValid=function(e,t){var r=new Date(e),n=new Date(t),o=!1;if("NaN"!==String(r.getDate())&&"NaN"!==String(n.getDate())){var a=new Date;o=a<n&&a>r}return o},e.getDeltaDays=function(e,t){e=new Date(e),t=new Date(t);var r=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),a=t.getFullYear(),i=t.getMonth()+1,f=t.getDate();e=new Date(r+"/"+n+"/"+o+" GMT+0800").getTime();var u=(t=new Date(a+"/"+i+"/"+f+" GMT+0800").getTime())-e;return Math.floor(u/864e5)},e.getMin=function(e){var t=null;if(e.constructor===Array)for(var r=e.length,n=0;n<r;n++)t=0===n?Number(e[0]):t>Number(e[n])?Number(e[n]):t;return t},e.formatTwoDigits=function(e){return(Array(2).join(0)+e).slice(-2)},e.formatDate=function(e,t){var r={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,String(e.getFullYear()).substr(4-RegExp.$1.length))),r)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?r[n]:("00"+r[n]).substr(String(r[n]).length)));return t},e.getDay=function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},e.formatName=function(e,t){t=t||6;var r=this._stringToArray(e),n="";if(r.length>t){for(var o=0;o<t;o++)n+=r[o];n+="..."}else n=e;return n},e.formatMoney=function(e){for(var t=["","K","M","G","T","P","E","Z","Y","B","N","D"],r="",n=0;n<t.length;n++){if(!(e>=1e4)){r=Math.floor(e)+t[n];break}e/=1e3}return""===r&&(r=Math.floor(e)+"U"),r},e.formatValue=function(e){for(var t=[],r="",n=0;n<26;n++)t.push(String.fromCharCode(97+n));for(var o=0;o<t.length;o++){if(!(e>=1e4)){r=Math.floor(e)+t[o];break}e/=1e3}return r},e.formatTimeForSecond=function(e,t){void 0===t&&(t=!1);var r="",n=e%60,o=Math.floor(e/60);o=o<0?0:o;var a=Math.floor(o/60),i=o%60;return a>0?(r+=a>9?a.toString():"0"+a,r+=":"):r+="00:",r+=i>9?i.toString():"0"+i,t||(r+=":",r+=n>9?n.toString():"0"+n),r},e.formatTimeForMillisecond=function(e){var t=Math.floor(e/1e3%60),r=Math.floor(e/1e3/60%60);return{hour:Math.floor(e/1e3/60/60),minute:r,second:t}},e.rand=function(e){for(var t=this.clone(e),r=t.length-1;r>=0;r--){var n=Math.floor(Math.random()*(r+1)),o=t[n];t[n]=t[r],t[r]=o}return t},e.getOffsetMimutes=function(e,t){var r=t-e;return Math.floor(r%36e5/6e4)},e.formatNumToFixed=function(e,t){return void 0===t&&(t=0),Number(e.toFixed(t))},e.lerp=function(e,t,r){void 0===r&&(r=.25);var n=t;return e>t?n=t+(e-t)*r:e<t&&(n=t-(t-e)*r),n},e.decrypt=function(e){var t=6;e.length%2==0&&(t=7);for(var r="",n=0;n<e.length-t;n+=2)r+=e[n+1],r+=e[n];return r+=e.slice(e.length-t+1),r=this._base64Decode(r)},e.encrypt=function(e){var t=this._base64encode(e),r=6;t.length%2==0&&(r=7);for(var n="",o=0;o<(t.length-r+1)/2;o++)n+=t[2*o+1],n+=t[2*o];return n+=t.slice(t.length-r+1)},e._base64encode=function(e){var t,r,n,o,a,i,f,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="",c=0;for(e=this._utf8Encode(e);c<e.length;)o=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(r=e.charCodeAt(c++))>>4,i=(15&r)<<2|(n=e.charCodeAt(c++))>>6,f=63&n,isNaN(r)?i=f=64:isNaN(n)&&(f=64),h=h+u.charAt(o)+u.charAt(a)+u.charAt(i)+u.charAt(f);return h},e._utf8Encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},e._utf8Decode=function(e){for(var t="",r=0,n=0,o=0,a=0;r<e.length;)(n=e.charCodeAt(r))<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(o=e.charCodeAt(r+1),t+=String.fromCharCode((31&n)<<6|63&o),r+=2):(o=e.charCodeAt(r+1),a=e.charCodeAt(r+2),t+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&a),r+=3);return t},e._base64Decode=function(e){var t,r,n,o,a,i,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",h=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<e.length;)t=f.indexOf(e.charAt(h++))<<2|(o=f.indexOf(e.charAt(h++)))>>4,r=(15&o)<<4|(a=f.indexOf(e.charAt(h++)))>>2,n=(3&a)<<6|(i=f.indexOf(e.charAt(h++))),u+=String.fromCharCode(t),64!=a&&(u+=String.fromCharCode(r)),64!=i&&(u+=String.fromCharCode(n));return u=this._utf8Decode(u)},e.checkIsLowPhone=function(){var e=window.wx;if(e){var t=-1,r=e.getSystemInfoSync();if(r.system.indexOf("iOS")>=0){for(var n=r.model,o=["iPhone1,1","iPhone1,2","iPhone2,1","iPhone3,1","iPhone3,3","iPhone4,1","iPhone5,1","iPhone5,2","iPhone5,3","iPhone5,4","iPhone6,1","iPhone6,2"],a=["iPhone6,2","iPhone7,1","iPhone7,2","iPhone8,1","iPhone8,2","iPhone8,4"],i=["iPhone9,1","iPhone9,2","iPhone9,3","iPhone9,4","iPhone10,1","iPhone10,2","iPhone10,3","iPhone10,4","iPhone10,5","iPhone10,6","iPhone XS"],f=["iPhone11,2","iPhone11,4","iPhone11,6","iPhone11,8","iPhone12,1","iPhone12,3","iPhone12,5","iPhone12,8","iPhone13 ","iPhone 14"],u=0;u<o.length;u++)n.indexOf(o[u])>=0&&(t=5);for(var h=0;h<a.length;h++)n.indexOf(a[h])>=0&&(t=10);for(var c=0;c<i.length;c++)n.indexOf(i[c])>=0&&(t=20);for(var g=0;g<f.length;g++)n.indexOf(f[g])>=0&&(t=30)}else t=r.benchmarkLevel;return t<22}return!1},e.showLabelTween=function(e,t,r,n){void 0===n&&(n=50);var o=e.node;o.getPosition(v);var a=v.x+(Math.random()-.5)*n/2,f=v.y+n,u=Math.min(t/3,.2);o.setScale(.1,.1),i(o.position).to(t,{x:a,y:f},{onUpdate:function(e,t){o.position=e},easing:"cubicInOut"}).call(r).start(),i(o.scale).delay(u).to(t-u,{x:2,y:2},{onUpdate:function(e,t){o.scale=e},easing:"cubicInOut"}).start()},e.getAngleBetweenVectors=function(e,t){var r=f.dot(e,t)/(e.length()*t.length()),n=Math.acos(r);return u.radiansToDegrees(n)},e.getAngleXVectors=function(e){var t=f.UNIT_X,r=f.dot(e,t)/e.length(),n=Math.acos(r);return u.radiansToDegrees(n)},e.getScreenToWorld=function(e,t,r){return void 0===r&&(r=.5),v.set(e.x,e.y,r),l.camera.screenToWorld(v,t)},e.createSphere=function(e,t,r){var n=new h("Test球");n.parent=e,n.setPosition(r);var o=new c(c.PrimitiveType.SPHERE);o.info=t,o.onLoaded();var a=n.addComponent(g);return a.mesh=o,a.material=m,n.layer=e.layer,n},e}())||d);t._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});