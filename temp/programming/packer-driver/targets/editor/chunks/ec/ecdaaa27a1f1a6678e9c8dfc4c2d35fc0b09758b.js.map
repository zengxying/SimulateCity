{"version":3,"sources":["file:///D:/cocos_work/SimulateCity/assets/src/component/OperateComp.ts"],"names":["_decorator","Component","input","Input","KeyCode","v2","GlobalConst","MsgEvent","Msg","MapOperateComp","MapOperateLogic","BuildingOperateLogic","ccclass","property","OperateComp","rotaWheelSpeed","mapOperateLogic","buildingOperateLogic","keys","key2dirMap","onLoad","inputEvent","getTarget","on","EventType","MOUSE_WHEEL","onMouseWheel","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDestroy","off","e","interruptMapOp","console","warn","log","getScrollX","getScrollY","delta","emit","OP_TOUCH_SCALE","event","keyCode","KEY_A","KEY_S","KEY_D","KEY_W","indexOf","push","updateDirection","KEY_Q","ins","setRotaCamera","KEY_E","index","splice","keyCode0","length","keyCode1","dir","cameraMoveDir","x","z","y"],"mappings":"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","sourcesContent":["import { _decorator, Component, Vec2, input, Input, EventMouse, EventTouch, misc, Vec3, EventKeyboard, KeyCode, v2 } from \"cc\";\r\nimport { GlobalConst, v2_2, v2_1, v2_3, v2_4, v3_1, v3_2 } from \"../GlobalConst\";\r\nimport { Util } from \"../framework/util\";\r\nimport { MsgEvent } from \"../msg/MsgEvent\";\r\nimport { Msg } from \"../msg/msg\";\r\nimport { CameraControllerComp } from \"./mapOp/CameraControllerComp\";\r\nimport { MapOperateComp } from \"./mapOp/MapOperateComp\";\r\nimport { MapOperateLogic } from \"../operate/MapOperateLogic\";\r\nimport { BuildingOperateLogic } from \"../operate/BuildingOperateLogic\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n/**\r\n * \r\n11.双指缩放，旋转  同时触发 也就是说有距离移动就缩放，有方向变化就旋转\r\n\r\n1.建造物的拖拽\r\n2.从ui拖出一个建筑物\r\n3.建造物各种状态的实时切换，不能放置，等\r\n\r\n4.滑动和点击的区分，用于建造时是切换建造物的位置还是移动视野\r\n5.长按建造物触发建筑物位置切换操作\r\n6.点击ui触发ui事件\r\n7.如果建造物的ui是3d的ui是否可用于触摸点击  或者是2d的ui怎么处理变化\r\n8.产出物品的拾取\r\n9.建造物升级添加材料的操作\r\n10.建筑物的回收操作\r\n12.玩家不同的操作对于3d世界的影响，各种颜色变换滤镜等\r\n(1)可支持的3d场景面数，精细度\t\t\r\n(2)选中房屋拖动时 房屋类型的建筑物会保持原有颜色，其他地图物体变换成灰色 这块的处理规则那就是保持个类型建造的引用封装处理，也可以实现倒是\r\n(3)各种建筑物的状态，生产，还是定时开启等\r\n */\r\n\r\n@ccclass('OperateComp')\r\nexport class OperateComp extends Component {\r\n\r\n\r\n    // 滚轮缩放的速度\r\n    rotaWheelSpeed: number = 0.1;\r\n\r\n    mapOperateLogic:MapOperateLogic = new MapOperateLogic();\r\n    buildingOperateLogic:BuildingOperateLogic;\r\n    public onLoad() {\r\n        const inputEvent = this.getTarget();\r\n        this.buildingOperateLogic = new BuildingOperateLogic(this);\r\n        inputEvent.on(Input.EventType.MOUSE_WHEEL, this.onMouseWheel, this);\r\n        inputEvent.on(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n        inputEvent.on(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        inputEvent.on(Input.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        inputEvent.on(Input.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n\r\n\r\n        inputEvent.on(Input.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        inputEvent.on(Input.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    public onDestroy() {\r\n        const inputEvent = this.getTarget();\r\n        inputEvent.off(Input.EventType.MOUSE_WHEEL, this.onMouseWheel, this);\r\n        inputEvent.off(Input.EventType.TOUCH_START, this.onTouchStart, this);\r\n        inputEvent.off(Input.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        inputEvent.off(Input.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        inputEvent.off(Input.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\r\n\r\n        inputEvent.off(Input.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        inputEvent.off(Input.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n\r\n    protected getTarget(): any {\r\n        return input;\r\n    }\r\n\r\n\r\n\r\n    public onMouseWheel(e: EventMouse) {\r\n        if (GlobalConst.interruptMapOp) return console.warn(\"中断操作中...............\");\r\n        console.log(`滚轮滚动的参数 getScrollX：${e.getScrollX()}  getScrollY:${e.getScrollY()}`)\r\n        const delta = -e.getScrollY() * this.rotaWheelSpeed * 0.1; // delta is positive when scroll down\r\n        Msg.emit(MsgEvent.OP_TOUCH_SCALE, delta);\r\n\r\n        // // // 将数据放出去\r\n        // Vec3.transformQuat(v3_1, Vec3.UNIT_Z, this.node.rotation);\r\n        // Vec3.scaleAndAdd(this._position, this.node.position, v3_1, delta);\r\n    }\r\n\r\n    public onTouchStart(e: EventTouch) {\r\n        this.mapOperateLogic.onTouchStart(e);\r\n        // this.buildingOperateLogic.onTouchStart(e);\r\n    }\r\n\r\n    public onTouchMove(e: EventTouch) {\r\n        // this.buildingOperateLogic.onTouchMove(e);\r\n        // if(! this.buildingOperateLogic.checkMoveBuild()){\r\n            this.mapOperateLogic.onTouchMove(e);\r\n        // }\r\n    }\r\n\r\n    public onTouchEnd(e: EventTouch) {\r\n        this.buildingOperateLogic.onTouchEnd(e);\r\n        \r\n        this.mapOperateLogic.onTouchEnd(e);\r\n    }\r\n\r\n    private keys = [];\r\n    // x  -1 left, +1 right   y -1 backword, +1 forward\r\n\r\n    onKeyDown(event: EventKeyboard) {\r\n        if (GlobalConst.interruptMapOp) return console.warn(\"中断操作中...............\");\r\n\r\n        let keyCode = event.keyCode;\r\n        if (keyCode == KeyCode.KEY_A || keyCode == KeyCode.KEY_S || keyCode == KeyCode.KEY_D || keyCode == KeyCode.KEY_W) {\r\n            if (this.keys.indexOf(keyCode) == -1) {\r\n                this.keys.push(keyCode);\r\n                this.updateDirection();\r\n            }\r\n        }\r\n        if (keyCode == KeyCode.KEY_Q) {\r\n            // 测试旋转\r\n            // MapOperateComp.ins.calculateRotaAxis();\r\n            // MapOperateComp.ins.setRotaPos(10);\r\n            \r\n            MapOperateComp.ins.setRotaCamera(1);\r\n            // GlobalConst.cameraMoveDir.y = -1;\r\n        }\r\n        else if (keyCode == KeyCode.KEY_E) {\r\n            MapOperateComp.ins.setRotaCamera(-1);\r\n            // GlobalConst.cameraMoveDir.y = 1;\r\n        }\r\n    }\r\n\r\n    onKeyUp(event: EventKeyboard) {\r\n        if (GlobalConst.interruptMapOp) return console.warn(\"中断操作中...............\");\r\n\r\n        let keyCode = event.keyCode;\r\n        if (keyCode == KeyCode.KEY_A || keyCode == KeyCode.KEY_S || keyCode == KeyCode.KEY_D || keyCode == KeyCode.KEY_W) {\r\n            let index = this.keys.indexOf(keyCode);\r\n            if (index != -1) {\r\n                this.keys.splice(index, 1);\r\n                this.updateDirection();\r\n            }\r\n        }\r\n\r\n        if (keyCode == KeyCode.KEY_Q || keyCode == KeyCode.KEY_E) {\r\n            // GlobalConst.cameraMoveDir.y = 0;\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    private key2dirMap = null;\r\n\r\n    updateDirection() {\r\n        if (this.key2dirMap == null) {\r\n            this.key2dirMap = {};\r\n            this.key2dirMap[0] = v2(0, 0);\r\n            this.key2dirMap[KeyCode.KEY_A] = v2(-1, 0);\r\n            this.key2dirMap[KeyCode.KEY_D] = v2(1, 0);\r\n            this.key2dirMap[KeyCode.KEY_W] = v2(0, 1);\r\n            this.key2dirMap[KeyCode.KEY_S] = v2(0, -1);\r\n\r\n            this.key2dirMap[KeyCode.KEY_A * 1000 + KeyCode.KEY_W] = this.key2dirMap[KeyCode.KEY_W * 1000 + KeyCode.KEY_A] = v2(-1, 1);\r\n            this.key2dirMap[KeyCode.KEY_D * 1000 + KeyCode.KEY_W] = this.key2dirMap[KeyCode.KEY_W * 1000 + KeyCode.KEY_D] = v2(1, 1);\r\n            this.key2dirMap[KeyCode.KEY_A * 1000 + KeyCode.KEY_S] = this.key2dirMap[KeyCode.KEY_S * 1000 + KeyCode.KEY_A] = v2(-1, -1);\r\n            this.key2dirMap[KeyCode.KEY_D * 1000 + KeyCode.KEY_S] = this.key2dirMap[KeyCode.KEY_S * 1000 + KeyCode.KEY_D] = v2(1, -1);\r\n\r\n            this.key2dirMap[KeyCode.KEY_A * 1000 + KeyCode.KEY_D] = this.key2dirMap[KeyCode.KEY_D];\r\n            this.key2dirMap[KeyCode.KEY_D * 1000 + KeyCode.KEY_A] = this.key2dirMap[KeyCode.KEY_A];\r\n            this.key2dirMap[KeyCode.KEY_W * 1000 + KeyCode.KEY_S] = this.key2dirMap[KeyCode.KEY_S];\r\n            this.key2dirMap[KeyCode.KEY_S * 1000 + KeyCode.KEY_W] = this.key2dirMap[KeyCode.KEY_W];\r\n        }\r\n        let keyCode0 = this.keys[this.keys.length - 1] || 0;\r\n        let keyCode1 = this.keys[this.keys.length - 2] || 0;\r\n        let dir = this.key2dirMap[keyCode1 * 1000 + keyCode0];\r\n        GlobalConst.cameraMoveDir.x = dir.x;\r\n        GlobalConst.cameraMoveDir.z = dir.y;\r\n    }\r\n}\r\n"]}