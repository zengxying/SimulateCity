{"version":3,"sources":["file:///D:/cocos_work/SimulateCity/assets/src/res.ts"],"names":["Res","resources","error","Prefab","instantiate","TextAsset","JsonAsset","Texture2D","EffectAsset","AudioClip","AnimationClip","ImageAsset","SpriteFrame","SpriteAtlas","Mesh","Material","Skeleton","SceneAsset","Vec3","director","Msg","load","path","type","cb","count","err","res","message","emit","loadJson","loadTxt","loadPrefab","loadTex2D","loadImage","loadSprite","loadSpriteAtlas","loadEffect","loadAudio","loadAnimationClip","loadMesh","loadMateiral","loadSkeleton","loadScene","inst","asset","root","undefined","pos","ZERO","instObj","getScene","addChild","setParent","setPosition","setScale","ONE","instNode","node","loadDir","loadDirJson","loadDirPrefab","loadDirText","loadDirSprite","loadDirSound"],"mappings":"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","sourcesContent":["import { _decorator, resources, Node, Asset, error, Constructor, Prefab, instantiate, TextAsset, JsonAsset, Texture2D, EffectAsset, AudioClip, AnimationClip, ImageAsset, SpriteFrame, SpriteAtlas, Mesh, Material, Skeleton, SceneAsset, Vec3, director } from 'cc';\nimport { Msg } from './msg/msg';\n\nexport class Res {\n\n    public static count: number = 0;\n\n    public static load<T extends Asset>(path: string, type: Constructor<T> | null, cb?: (err: Error | null, asset?: T | null)=>void) {\n        this.count++;\n        resources.load(path, type, function(err, res){\n            if (err){\n                error(path,err.message || err);\n                Msg.emit('msg_res_error');\n            }\n            if (cb) {\n                cb(err, res);\n            }\n            Res.count--;\n            Msg.emit('msg_check_res_cache_end');\n        });\n    }\n\n    public static loadJson(path: string, cb?: (err: Error | null, asset?: JsonAsset | null)=>void) {\n        this.load(path, JsonAsset, cb);\n    }\n\n    public static loadTxt(path: string, cb?: (err: Error | null, asset?: TextAsset | null)=>void) {\n        this.load(path, TextAsset, cb);\n    }\n\n    public static loadPrefab(path: string, cb?: (err: Error | null, asset?: Prefab | null)=>void) {\n        this.load(path, Prefab, cb);\n    }\n\n    public static loadTex2D(path: string, cb?: (err: Error | null, asset?: Texture2D | null)=>void) {\n        this.load(path, Texture2D, cb);\n    }\n    \n    public static loadImage(path: string, cb?: (err: Error | null, asset?: ImageAsset | null)=>void) {\n        this.load(path, ImageAsset, cb);\n    }\n\n    public static loadSprite(path: string, cb?: (err: Error | null, asset?: SpriteFrame | null)=>void) {\n        this.load(path, SpriteFrame, cb);\n    }\n\n    public static loadSpriteAtlas(path: string, cb?: (err: Error | null, asset?: SpriteAtlas | null)=>void) {\n        this.load(path, SpriteAtlas, cb);\n    }\n\n    public static loadEffect(path: string, cb?: (err: Error | null, asset?: EffectAsset | null)=>void) {\n        this.load(path, EffectAsset, cb);\n    }\n\n    public static loadAudio(path: string, cb?: (err: Error | null, asset?: AudioClip | null)=>void) {\n        this.load(path, AudioClip, cb);\n    }\n\n    public static loadAnimationClip(path: string, cb?: (err: Error | null, asset?: AnimationClip | null)=>void) {\n        this.load(path, AnimationClip, cb);\n    }\n\n    public static loadMesh(path: string, cb?: (err: Error | null, asset?: Mesh | null)=>void) {\n        this.load(path, Mesh, cb);\n    }\n\n    public static loadMateiral(path: string, cb?: (err: Error | null, asset?: Material | null)=>void) {\n        this.load(path, Material, cb);\n    }\n\n    public static loadSkeleton(path: string, cb?: (err: Error | null, asset?: Skeleton | null)=>void) {\n        this.load(path, Skeleton, cb);\n    }\n\n    public static loadScene(path: string, cb?: (err: Error | null, asset?: SceneAsset | null)=>void) {\n        this.load(path, SceneAsset, cb);\n    }\n\n\n    public static inst(asset: Prefab, root:Node | undefined = undefined,  pos:Vec3 = Vec3.ZERO) : Node {\n        const instObj = instantiate(asset);\n        if (root === undefined) {\n            director.getScene()?.addChild(instObj);\n        }else{\n            instObj.setParent(root);\n        }\n        instObj.setPosition(pos);\n        instObj.setScale(Vec3.ONE);\n        return instObj;\n    }\n\n    public static instNode(node:Node, root:Node | undefined = undefined, pos:Vec3 = Vec3.ZERO) : Node {\n        const instObj = instantiate(node);\n        if (root === undefined) {\n            director.getScene()?.addChild(instObj);\n        }else{\n            instObj.setParent(root);\n        }\n        instObj.setPosition(pos);\n        instObj.setScale(Vec3.ONE);\n        return instObj;\n    }\n\n    public static loadDir<T extends Asset>(path: string, type: Constructor<T> | null, cb?: (err: Error | null, asset?: T[] | null)=>void) {\n        this.count++;\n        resources.loadDir(path, type, function(err, res){\n            if (err){\n                error(err.message || err);\n                Msg.emit('msg_res_error');\n            }\n            if (cb) {\n                cb(err, res);\n            }\n            Res.count--;\n            Msg.emit('msg_check_res_cache_end');\n        });\n    }\n\n    public static loadDirJson(path:string, cb?: (err: Error | null, asset?: JsonAsset[] | null)=>void) {\n        this.loadDir(path, JsonAsset, cb);\n    }\n\n    public static loadDirPrefab(path:string, cb?: (err: Error | null, asset?: Prefab[] | null)=>void) {\n        this.loadDir(path, Prefab, cb);\n    }\n\n    public static loadDirText(path:string, cb?: (err: Error | null, asset?: TextAsset[] | null)=>void) {\n        this.loadDir(path, TextAsset, cb);\n    }\n\n    public static loadDirSprite(path:string, cb?: (err: Error | null, asset?: SpriteFrame[] | null)=>void) {\n        this.loadDir(path, SpriteFrame, cb);\n    }\n\n    public static loadDirSound(path:string, cb?: (err:Error | null, asset?: AudioClip[] | null)=>void) {\n        this.loadDir(path, AudioClip, cb);\n    }\n\n}\n"]}