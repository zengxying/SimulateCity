{"version":3,"sources":["file:///D:/cocos_work/games/SimulateCity/assets/src/framework/csv2json.ts"],"names":["parseCSV","csv","resultArr","lines","split","formats","headers","i","l","length","replace","obj","currentline","console","warn","j","val","startsWith","Number","push"],"mappings":";;;;;;;;;;;;;;0BAAMA,Q,GAAW,UAAUC,GAAV,EAAe;AAC5B,cAAMC,SAAS,GAAG,EAAlB,CAD4B,CACN;AACtB;;AACA,cAAMC,KAAK,GAAGF,GAAG,CAACG,KAAJ,CAAU,IAAV,CAAd,CAH4B,CAI5B;;AACA,cAAMC,OAAO,GAAGF,KAAK,CAAC,CAAD,CAAL,CAASC,KAAT,CAAe,GAAf,CAAhB,CAL4B,CAM5B;;AACA,cAAME,OAAO,GAAGH,KAAK,CAAC,CAAD,CAAL,CAASC,KAAT,CAAe,GAAf,CAAhB;;AACA,aAAK,IAAIG,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGF,OAAO,CAACG,MAA5B,EAAoCF,CAAC,GAAGC,CAAxC,EAA2CD,CAAC,EAA5C,EAAgD;AAC5CD,UAAAA,OAAO,CAACC,CAAD,CAAP,GAAaD,OAAO,CAACC,CAAD,CAAP,CAAWG,OAAX,CAAmB,QAAnB,EAA6B,EAA7B,CAAb;AACH;;AACD,aAAK,IAAIH,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGL,KAAK,CAACM,MAAN,GAAe,CAAnC,EAAsCF,CAAC,GAAGC,CAA1C,EAA6CD,CAAC,EAA9C,EAAkD;AAC9C,gBAAMI,GAAG,GAAG,EAAZ;AACA,gBAAMC,WAAW,GAAGT,KAAK,CAACI,CAAD,CAAL,CAASH,KAAT,CAAe,GAAf,CAApB;;AACA,cAAIQ,WAAW,CAACH,MAAZ,KAAuBH,OAAO,CAACG,MAAnC,EAA2C;AACvCI,YAAAA,OAAO,CAACC,IAAR,CAAa,kBAAb;AAEA;AACH;;AAED,eAAK,IAAIC,CAAC,GAAG,CAAR,EAAWP,CAAC,GAAGF,OAAO,CAACG,MAA5B,EAAoCM,CAAC,GAAGP,CAAxC,EAA2CO,CAAC,EAA5C,EAAgD;AAC5C,gBAAIC,GAAG,GAAGJ,WAAW,CAACG,CAAD,CAArB;;AACA,gBAAIV,OAAO,CAACU,CAAD,CAAP,CAAWE,UAAX,CAAsB,GAAtB,CAAJ,EAAgC;AAC5BD,cAAAA,GAAG,GAAGE,MAAM,CAACF,GAAD,CAAZ;AACH,aAFD,MAEO;AACHA,cAAAA,GAAG,GAAGA,GAAG,CAACN,OAAJ,CAAY,UAAZ,EAAwB,EAAxB,CAAN;AACH;;AACDC,YAAAA,GAAG,CAACL,OAAO,CAACS,CAAD,CAAR,CAAH,GAAkBC,GAAlB;AACH,WAjB6C,CAkB9C;;;AACAd,UAAAA,SAAS,CAACiB,IAAV,CAAeR,GAAf;AACH;;AACD,eAAOT,SAAP,CAhC4B,CAgCV;AACrB,O","sourcesContent":["const parseCSV = function (csv) {\r\n    const resultArr = []; // 数组格式\r\n    // 分割行\r\n    const lines = csv.split('\\n');\r\n    // 格式\r\n    const formats = lines[1].split(',');\r\n    // 表头\r\n    const headers = lines[2].split(',');\r\n    for (let i = 0, l = headers.length; i < l; i++) {\r\n        headers[i] = headers[i].replace(/\\n|\\r/g, '');\r\n    }\r\n    for (let i = 3, l = lines.length - 1; i < l; i++) {\r\n        const obj = {};\r\n        const currentline = lines[i].split(\",\");\r\n        if (currentline.length !== headers.length) {\r\n            console.warn('csv中行的长度不等于表头的长度');\r\n\r\n            continue;\r\n        }\r\n\r\n        for (let j = 0, l = headers.length; j < l; j++) {\r\n            let val = currentline[j];\r\n            if (formats[j].startsWith('n')) {\r\n                val = Number(val);\r\n            } else {\r\n                val = val.replace(/[\\n|\\r]/g, '');\r\n            }\r\n            obj[headers[j]] = val;\r\n        }\r\n        // resultObj[obj[headers[0]]] = obj;\r\n        resultArr.push(obj);\r\n    }\r\n    return resultArr; // JavaScript object\r\n};\r\n\r\nexport { parseCSV };"]}